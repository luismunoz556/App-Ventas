function eliminarProducto(e,t){document.getElementById("id-producto-eliminar").value=e,document.getElementById("nombre-producto").textContent=t,document.getElementById("modal-eliminar").style.display="flex"}function eliminarCliente(e,t){document.getElementById("id-cliente-eliminar").value=e,document.getElementById("nombre-cliente").textContent=t,document.getElementById("modal-eliminar").style.display="flex"}function eliminarVenta(e,t){document.getElementById("id-venta-eliminar").value=e,document.getElementById("nombre-venta").textContent=t,document.getElementById("modal-eliminar").style.display="flex"}function cerrarModal(){document.getElementById("modal-eliminar").style.display="none"}function inicializarProductos(){const e=document.getElementById("buscar-productos");e&&e.addEventListener("input",function(e){const t=e.target.value.toLowerCase();document.querySelectorAll(".tabla-productos tbody tr").forEach(e=>{e.textContent.toLowerCase().includes(t)?e.style.display="":e.style.display="none"})});const t=document.getElementById("modal-eliminar");t&&t.addEventListener("click",function(e){e.target===this&&cerrarModal()})}function inicializarClientes(){const e=document.getElementById("buscar-clientes");e&&e.addEventListener("input",function(e){const t=e.target.value.toLowerCase();document.querySelectorAll(".tabla-clientes tbody tr").forEach(e=>{e.textContent.toLowerCase().includes(t)?e.style.display="":e.style.display="none"})});const t=document.getElementById("modal-eliminar");t&&t.addEventListener("click",function(e){e.target===this&&cerrarModal()})}function inicializarFormularioVentas(){const e=document.getElementById("lista-productos"),t=document.getElementById("tpl-tarjeta-producto"),n=document.getElementById("btn-agregar-producto"),o=document.getElementById("total"),l=document.getElementById("tipo_pago"),a=document.getElementById("credito"),i=document.getElementById("cantidad-productos"),r=document.getElementById("total-pedido");if(!e||!t||!n)return;let c=0,d=1;function u(e){return parseFloat(e||0).toLocaleString("es-ES",{minimumFractionDigits:2,maximumFractionDigits:2})}function s(){let t=0,n=0,l=!1;e.querySelectorAll(".tarjeta-producto").forEach(e=>{const o=parseFloat(e.querySelector(".input-cantidad")?.value||"0"),a=parseFloat(e.querySelector(".input-precio")?.value||"0"),i=o*a,r=e.querySelector(".input-subtotal");Number.isNaN(i)||(t+=i,n+=o,r&&(r.value=u(i)),o>0&&a>0&&(l=!0))}),void 0===s.totalInicial&&o&&(s.totalInicial=parseFloat(o.value||"0")),l&&(o&&(o.value=t.toFixed(2)),r&&(r.textContent="$"+u(t)),i&&(i.textContent=n))}function m(t){const n=t.querySelector(".select-producto, .input-producto-id"),o=t.querySelector(".input-cantidad"),l=t.querySelector(".input-precio"),a=t.querySelector(".btn-eliminar-producto");n&&"SELECT"===n.tagName&&n.addEventListener("change",function(){const e=this.options[this.selectedIndex],t=parseFloat(e.getAttribute("data-precio")||"0");!Number.isNaN(t)&&l&&(l.value=t.toFixed(2),s())}),[o,l].forEach(e=>{e&&e.addEventListener("input",function(){s()})}),a&&a.addEventListener("click",function(){e.querySelectorAll(".tarjeta-producto").length<=1?alert("Debe haber al menos un producto en el pedido"):(t.style.animation="fadeOut 0.3s ease-out",setTimeout(()=>{t.remove(),s()},300))})}function y(){const n=t.innerHTML.replaceAll("__INDEX__",String(c++)).replace("__NUM__",String(d++)),o=document.createElement("div");o.innerHTML=n;const l=o.querySelector(".tarjeta-producto");l&&(l.style.opacity="0",l.style.transform="translateY(-10px)",e.appendChild(l),setTimeout(()=>{l.style.transition="all 0.3s ease-in",l.style.opacity="1",l.style.transform="translateY(0)"},10),m(l),s())}function p(){l&&a&&("credito"===l.value?(a.removeAttribute("readonly"),a.style.backgroundColor="#fff"):(a.setAttribute("readonly","readonly"),a.value="0",a.style.backgroundColor="#f5f5f5"))}n.addEventListener("click",y),l&&(l.addEventListener("change",p),p()),function(){if(o&&r){const e=parseFloat(o.value||"0");!Number.isNaN(e)&&e>0&&(r.textContent="$"+u(e))}}(),e.querySelectorAll(".tarjeta-producto").forEach(t=>{m(t);const n=t.querySelector(".numero-producto");if(n){const o=Array.from(e.querySelectorAll(".tarjeta-producto")).indexOf(t);n.textContent="#"+(o+1)}}),c=e.querySelectorAll(".tarjeta-producto").length,d=c+1,0===e.querySelectorAll(".tarjeta-producto").length?y():s()}document.addEventListener("DOMContentLoaded",function(){console.log("JavaScript cargado correctamente");const e=document.getElementById("mobile-menu-btn"),t=document.getElementById("mobile-menu-dropdown");if(console.log("Botón encontrado:",e),console.log("Dropdown encontrado:",t),e&&t){console.log("Agregando event listeners"),e.addEventListener("click",function(e){console.log("Click en botón hamburguesa"),e.stopPropagation(),t.classList.toggle("active"),console.log("Clase active toggleada")}),document.addEventListener("click",function(n){e.contains(n.target)||t.contains(n.target)||t.classList.remove("active")});t.querySelectorAll(".mobile-nav-item").forEach(e=>{e.addEventListener("click",function(){t.classList.remove("active")})}),t.addEventListener("click",function(e){e.stopPropagation()})}else console.log("No se encontraron los elementos del menú móvil");inicializarProductos(),inicializarClientes(),inicializarFormularioVentas()});